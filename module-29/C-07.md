**Dashboard-à¦à¦° à¦œà¦¨à§à¦¯ à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ Prisma-based Statistics design** --
à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦‡à¦—à§à¦²à§‹ à¦¥à¦¾à¦•à¦¬à§‡ ðŸ‘‡

- `postCount`
- `publishedPost`
- `draftPost`
- `totalComment`
- `totalViews`

# ðŸ“Š Dashboard Statistics (Prisma)

## ðŸŽ¯ Target Metrics

| Key           | à¦®à¦¾à¦¨à§‡                |
| ------------- | ------------------- |
| postCount     | à¦®à§‹à¦Ÿ Post            |
| publishedPost | Published Post      |
| draftPost     | Draft Post          |
| totalComment  | à¦®à§‹à¦Ÿ Comment         |
| totalViews    | à¦¸à¦¬ Post-à¦à¦° à¦®à§‹à¦Ÿ View |

## ðŸ› ï¸ Service Layer (Statistics Logic)

ðŸ“ `dashboard.service.ts`

```ts
import { prisma } from "@/lib/prisma";

export const getDashboardStats = async () => {
  const [
    postCount,
    publishedPost,
    draftPost,
    totalComment,
    totalViews,
    totalUser,
    adminCount,
    userCount,
  ] = await Promise.all([
    // ðŸ“Œ Post statistics
    prisma.post.count(),

    prisma.post.count({
      where: { status: "PUBLISHED" },
    }),

    prisma.post.count({
      where: { status: "DRAFT" },
    }),

    // ðŸ“Œ Comment statistics
    prisma.comment.count(),

    // ðŸ“Œ Views statistics
    prisma.post.aggregate({
      _sum: {
        views: true,
      },
    }),

    // ðŸ“Œ User statistics
    prisma.user.count(),

    prisma.user.count({
      where: { role: "ADMIN" },
    }),

    prisma.user.count({
      where: { role: "USER" },
    }),
  ]);

  return {
    // ðŸ“ Post
    postCount,
    publishedPost,
    draftPost,

    // ðŸ’¬ Comment
    totalComment,

    // ðŸ‘€ Views
    totalViews: totalViews._sum.views ?? 0,

    // ðŸ‘¤ Users
    totalUser,
    adminCount,
    userCount,
  };
};
```

---

## ðŸ§  à¦•à§‡à¦¨ à¦à¦‡ Approach à¦­à¦¾à¦²à§‹?

| à¦¬à¦¿à¦·à§Ÿ          | à¦•à¦¾à¦°à¦£                       |
| ------------- | -------------------------- |
| `count()`     | Fast & optimized           |
| `aggregate()` | Views à¦¯à§‹à¦— à¦•à¦°à¦¾à¦° à¦¸à¦ à¦¿à¦• à¦‰à¦ªà¦¾à§Ÿ   |
| `Promise.all` | Parallel execution â†’ à¦¦à§à¦°à§à¦¤ |
| `?? 0`        | Null safety                |

---

## ðŸŽ® Controller Layer

ðŸ“ `dashboard.controller.ts`

```ts
import { getDashboardStats } from "./dashboard.service";

export const dashboardStatsController = async (req, res) => {
  const stats = await getDashboardStats();

  res.status(200).json({
    success: true,
    data: stats,
  });
};
```

---

## ðŸŒ API Route

```ts
router.get("/dashboard/stats", dashboardStatsController);
```

---

## ðŸ“¦ Final Dashboard Output (Frontend Ready)

```json
{
  "success": true,
  "data": {
    "postCount": 120,
    "publishedPost": 85,
    "draftPost": 35,
    "totalComment": 980,
    "totalViews": 24500,
    "totalUser": 410,
    "adminCount": 5,
    "userCount": 405
  }
}
```

ðŸ‘‰ à¦à¦‡ response à¦¸à¦°à¦¾à¦¸à¦°à¦¿

- **Dashboard card**
- **Statistics widget**
- **Admin panel**

à¦¸à¦¬ à¦œà¦¾à§Ÿà¦—à¦¾à§Ÿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¯à¦¾à¦¬à§‡à¥¤

---

## ðŸ“ˆ Extra (Optional à¦•à¦¿à¦¨à§à¦¤à§ Powerful)

### ðŸ”¹ Today / Last 7 Days Statistics

```ts
where: {
  createdAt: {
    gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
  },
}
```

### ðŸ”¹ Only Published Post Views

```ts
prisma.post.aggregate({
  where: { status: "PUBLISHED" },
  _sum: { views: true },
});
```

---

## ðŸ”‘ à¦à¦• à¦²à¦¾à¦‡à¦¨à§‡ à¦¸à¦¾à¦°à¦¾à¦‚à¦¶

> **Prisma Dashboard Statistics = count + aggregate + clean service layer**
