# â±ï¸ Time-Series Statistics (Complete Guide)

---

## 1ï¸âƒ£ Time-Series Statistics à¦•à§€?

**Time-Series Statistics** à¦¹à¦²à§‹ à¦à¦®à¦¨ à¦§à¦°à¦¨à§‡à¦° à¦¡à§‡à¦Ÿà¦¾ à¦¬à¦¿à¦¶à§à¦²à§‡à¦·à¦£ à¦¯à§‡à¦–à¦¾à¦¨à§‡ **à¦¸à¦®à§Ÿ (time)** à¦à¦•à¦Ÿà¦¿ à¦®à§‚à¦² à¦­à§‡à¦°à¦¿à§Ÿà§‡à¦¬à¦²à¥¤

- à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦¡à§‡à¦Ÿà¦¾ point à¦¯à§à¦•à§à¦¤ à¦¥à¦¾à¦•à§‡ à¦à¦•à¦Ÿà¦¿ **timestamp** à¦à¦° à¦¸à¦¾à¦¥à§‡
- à¦¸à¦®à§Ÿà§‡à¦° à¦¸à¦™à§à¦—à§‡ à¦•à§€à¦­à¦¾à¦¬à§‡ data à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¹à¦šà§à¦›à§‡ à¦¤à¦¾ à¦¬à§‹à¦à¦¾à§Ÿ

ðŸ“Œ à¦‰à¦¦à¦¾à¦¹à¦°à¦£:

- Daily active users (DAU)
- Monthly revenue growth
- Weekly post counts
- Hourly page views

---

## 2ï¸âƒ£ Time-Series vs Normal Statistics

| à¦¬à¦¿à¦·à§Ÿ       | Normal             | Time-Series                   |
| ---------- | ------------------ | ----------------------------- |
| Data focus | Snapshot           | Over time                     |
| Example    | Total users = 1000 | Users per day = [10, 20, 25â€¦] |
| Usage      | Dashboard card     | Graph, trend analysis         |
| DB query   | `count()`          | `groupBy(createdAt)`          |

---

## 3ï¸âƒ£ Database Design (Prisma Example)

à¦§à¦°à¦¿ `Post` model:

```prisma
model Post {
  id        String   @id @default(uuid())
  title     String
  status    PostStatus
  views     Int      @default(0)
  createdAt DateTime @default(now())
}

enum PostStatus {
  DRAFT
  PUBLISHED
}
```

- `createdAt` field = Time-series analysis à¦à¦° à¦œà¦¨à§à¦¯ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£

---

## 4ï¸âƒ£ Prisma à¦¦à¦¿à§Ÿà§‡ Time-Series Stats à¦¨à§‡à¦“à§Ÿà¦¾

### Example: Daily Post Count

```ts
const dailyPosts = await prisma.post.groupBy({
  by: ["createdAt"],
  _count: {
    id: true,
  },
  where: {
    createdAt: {
      gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000), // last 7 days
    },
  },
});
```

âœ… Output:

```json
[
  { "createdAt": "2026-01-04T00:00:00.000Z", "_count": { "id": 5 } },
  { "createdAt": "2026-01-05T00:00:00.000Z", "_count": { "id": 8 } },
  { "createdAt": "2026-01-06T00:00:00.000Z", "_count": { "id": 10 } }
]
```

---

### Example: Daily Views Sum

```ts
const dailyViews = await prisma.post.groupBy({
  by: ["createdAt"],
  _sum: { views: true },
  where: {
    createdAt: {
      gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), // last 30 days
    },
  },
});
```

âœ… Output:

```json
[
  { "createdAt": "2026-01-01", "_sum": { "views": 120 } },
  { "createdAt": "2026-01-02", "_sum": { "views": 200 } }
]
```

---

## 5ï¸âƒ£ Time Binning / Grouping

**Important:** Prisma `groupBy` default à¦­à¦¾à¦¬à§‡ timestamp à¦…à¦¨à§à¦¯à¦¾à§Ÿà§€ exact match à¦•à¦°à§‡à¥¤

- à¦¯à¦¦à¦¿ à¦¤à§à¦®à¦¿ **daily/monthly/hourly** grouping à¦šà¦¾à¦“ â†’ `createdAt` à¦•à§‡ truncate à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡

### Example: Daily truncate (PostgreSQL)

```ts
prisma.$queryRaw`
  SELECT DATE("createdAt") as day, COUNT(*) as total
  FROM "Post"
  WHERE "createdAt" >= NOW() - INTERVAL '7 days'
  GROUP BY day
  ORDER BY day ASC;
`;
```

---

## 6ï¸âƒ£ Caching + Time-Series (Performance)

- Dashboard / Analytics â†’ High traffic
- Daily posts / views â†’ Cache 10â€“60 sec à¦¬à¦¾ Cron-based refresh
- Redis à¦¦à¦¿à§Ÿà§‡ aggregate save à¦•à¦°à¦²à§‡ DB hit à¦•à¦®à§‡

---

## 7ï¸âƒ£ Visualization / Dashboard Use

Time-Series stats à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ **Graph / Chart** à¦ à¦¦à§‡à¦–à¦¾à¦¨à§‹ à¦¹à§Ÿ:

- Line Chart â†’ Trend over time
- Bar Chart â†’ Daily counts
- Area Chart â†’ Cumulative metrics
- Heatmap â†’ Hourly user activity

ðŸ“Œ Popular JS Chart libraries: **Recharts, Chart.js, ApexCharts**

---

## 8ï¸âƒ£ High Traffic Optimization

1. Pre-aggregate data â†’ Cron job

   ```text
   daily_post_count table
   daily_comment_count table
   ```

2. Cache aggregated data (Redis)
3. Limit time-range query â†’ last 7 days / 30 days
4. Only select necessary fields (`_count`, `_sum`)
5. Index on `createdAt`

---

## 9ï¸âƒ£ Example: Full Dashboard Service

```ts
export const getDailyStats = async (days = 7) => {
  const startDate = new Date(Date.now() - days * 24 * 60 * 60 * 1000);

  const posts = await prisma.post.groupBy({
    by: ["createdAt"],
    _count: { id: true },
    where: { createdAt: { gte: startDate } },
  });

  const comments = await prisma.comment.groupBy({
    by: ["createdAt"],
    _count: { id: true },
    where: { createdAt: { gte: startDate } },
  });

  return { posts, comments };
};
```

---

## 10ï¸âƒ£ Golden Rules for Time-Series Stats

1. Always filter by **time-range**
2. Use **groupBy** or **raw SQL aggregation**
3. Cache high-frequency queries
4. Pre-compute daily/monthly aggregates if traffic high
5. Index timestamp columns (`createdAt`)

---

## ðŸ§  One-Line Summary

> **Time-Series Statistics = Time-aware aggregation â†’ Trend analysis â†’ Dashboard & Analytics-ready**
