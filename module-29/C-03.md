# ЁЯУМ PrismaClientValidationError тАФ ржкрзВрж░рзНржг ржмрзНржпрж╛ржЦрзНржпрж╛ (Bangla)

## 1я╕ПтГг PrismaClientValidationError ржХрзА?

- Prisma Client **query ржкрж╛ржарж╛ржирзЛрж░ ржЖржЧрзЗ validate ржХрж░рзЗ**ред
- ржпржжрж┐ query **structure ржнрзБрж▓**, **field name typo**, ржмрж╛ **required field missing** рж╣рзЯ тЖТ Prisma **`PrismaClientValidationError` throw ржХрж░рзЗ**ред
- ржПржЯрж┐ **DB-level error ржирзЯ**ред Query execution рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ detect рж╣рзЯред
- рж╕рж╛ржзрж╛рж░ржгржд **developer ржмрж╛ frontend ржерзЗржХрзЗ ржкрж╛ржарж╛ржирзЛ ржнрзБрж▓ data** ржПржЗ error ржжрзЗрзЯред

> рж╕рж╣ржЬ ржнрж╛рж╖рж╛рзЯ: тАЬPrisma ржмрж▓ржЫрзЗ, рждрзЛржорж╛рж░ ржХрзЛржбрзЗ ржнрзБрж▓ ржЖржЫрзЗ, database ржП ржврзБржХрж╛рж░ ржЖржЧрзЗржЗредтАЭ

---

## 2я╕ПтГг ржХржЦржи рж╣рзЯ?

| Situation               | Example                             |
| ----------------------- | ----------------------------------- |
| Field name typo         | `titile` instead of `title`         |
| Required field missing  | `title` ржлрж┐рж▓рзНржб ржирж╛ ржжрзЗржУрзЯрж╛              |
| Wrong data type         | `id: 123` ржХрж┐ржирзНрждрзБ string рж╣ржУрзЯрж╛ ржЙржЪрж┐ржд   |
| Invalid nested relation | nested create / connect ржнрзБрж▓ржнрж╛ржмрзЗ ржХрж░рж╛ |
| Extra unknown field     | `foo: "bar"` ржХрзЛржирзЛ schema ржП ржирзЗржЗ      |

> ржорзВрж▓ржд **Developer mistake** ржмрж╛ **Frontend ржерзЗржХрзЗ ржнрзБрж▓ request** ржПрж░ ржЬржирзНржп рж╣рзЯред

---

## 3я╕ПтГг PrismaClientValidationError vs PrismaClientKnownRequestError

| Feature    | ValidationError                 | KnownRequestError                            |
| ---------- | ------------------------------- | -------------------------------------------- |
| Error name | PrismaClientValidationError     | PrismaClientKnownRequestError                |
| ржХржЦржи рж╣рзЯ     | Query build / validation stage  | Database execution stage                     |
| DB hit рж╣рзЯ? | тЭМ ржирж╛                           | тЬЕ рж╣рзНржпрж╛ржБ                                     |
| ржХрж╛рж░ржг       | Field/type missing, typo        | DB constraint violated (unique, foreign key) |
| Handle     | Global Error Handler тЖТ 400      | Global Error Handler тЖТ mapped message        |
| Message    | Generic: "Invalid request data" | Human readable: Duplicate, Not found, etc    |

> ржЕрж░рзНржерж╛рзО, **ValidationError тЖТ DB hit рж╣рзЯ ржирж╛**, KnownRequestError тЖТ DB try ржХрж░рзЗ constraint check ржХрж░рзЗред

---

## 4я╕ПтГг ржХрж┐ржнрж╛ржмрзЗ handle ржХрж░ржмрзЛ?

1. **Service / Controller ржП handle ржирж╛ ржХрж░рж╛**
   тЭМ try-catch рж▓рж╛ржЧрж╛ржирзЛ ржжрж░ржХрж╛рж░ ржирзЗржЗред
   тЭМ Controller ржП Prisma code ржирж┐рзЯрзЗ ржЪрж┐ржирзНрждрж╛ ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗред

2. **Global Error Handler ржП ржзрж░рзЛ**
   тЬЕ Express middleware рж╣рж┐рж╕рзЗржмрзЗ final handler ржП ржзрж░рзЛред

3. **Client ржХрзЗ Generic message ржкрж╛ржарж╛ржУ**
   тЭМ Raw Prisma message ржкрж╛ржарж╛ржирзЛ ржарж┐ржХ ржирзЯ (schema leak ржмрж╛ security risk)ред
   тЬЕ Production: `"Invalid request data"`

---

## 5я╕ПтГг Global Error Handler Example

ЁЯУН `src/middlewares/globalErrorHandler.ts`

```ts
// import { handlePrismaError } from "../errors/handlePrismaError";

export const globalErrorHandler = (err, req, res, next) => {
  let statusCode = 500;
  let message = "Something went wrong";

  //  Prisma Known Request Error
  // if (err.name === "PrismaClientKnownRequestError") {
  //   const simplified = handlePrismaError(err);
  //   statusCode = simplified.statusCode;
  //   message = simplified.message;
  // }
  // Prisma Validation Error
  // else
  if (err.name === "PrismaClientValidationError") {
    statusCode = 400;
    message = "Invalid request data"; // Generic message
  }

  res.status(statusCode).json({
    success: false,
    message,
  });
};
```

> рж▓ржХрзНрж╖рзНржп ржХрж░рзЛ: ValidationError ржПрж░ ржЬржирзНржп **ржХрзЛржирзЛ mapping function рж▓рж╛ржЧржЫрзЗ ржирж╛**, рж╢рзБржзрзБ generic 400 responseред

---

## 6я╕ПтГг Real Example

### тЭМ Field name typo

```ts
await prisma.post.create({
  data: {
    titile: "Hello World", // typo! ржнрзБрж▓
  },
});
```

- Prisma throws: `PrismaClientValidationError`
- Client gets:

```json
{
  "success": false,
  "message": "Invalid request data"
}
```

### тЭМ Missing required field

```ts
await prisma.post.create({
  data: {
    content: "This is post content", // missing title ред ржПржЦрж╛ржирзЗ title ржирж╛ ржжрж┐рзЯрж╛ржЯрж╛ ржнрзБрж▓
  },
});
```

- Prisma throws same error
- Client gets same generic 400 response

---

## 7я╕ПтГг Important Notes

- **Controller / Service**: ValidationError ржирж┐рзЯрзЗ ржнрж╛ржмрзЛ ржирж╛ред
- **Global Error Handler**: рж╢рзБржзрзБ ржзрж░рзЛред
- **Message**: Client-friendly, generic рж╣ржмрзЗ ред
- **Database hit рж╣рзЯ ржирж╛**, рждрж╛ржЗ performance impact ржирзЗржЗред
- **Developer debugging**: console.log(err) ржмрж╛ Sentry/Logger ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯ ред

---

## 8я╕ПтГг Summary Table

| Feature                     | PrismaClientValidationError                          |
| --------------------------- | ---------------------------------------------------- |
| ржХрзЗржи рж╣рзЯ                      | Query structure invalid / wrong type / missing field |
| ржХрзЛржерж╛рзЯ handle                | Global Error Handler                                 |
| Client response             | 400 Bad Request + generic message                    |
| Controller / Service handle | тЭМ catchAsync тЖТ global handler automatically         |
| DB hit рж╣рзЯ?                  | тЭМ ржирж╛                                                |

---

ЁЯТб **Interview Ready One-liner (Bangla)**

> тАЬPrismaClientValidationError рж╣рзЯ ржпржЦржи query structure ржнрзБрж▓ ржмрж╛ required field missing рж╣рзЯ; ржПржЯрж┐ database hit рж╣ржУрзЯрж╛рж░ ржЖржЧрзЗржЗ Prisma detect ржХрж░рзЗ ржПржмржВ global error handler-ржП 400 response ржкрж╛ржарж╛ржирзЛ ржЙржЪрж┐ржд, Controller ржмрж╛ Service-ржП handle ржХрж░рж╛рж░ ржжрж░ржХрж╛рж░ ржирзЗржЗредтАЭ
