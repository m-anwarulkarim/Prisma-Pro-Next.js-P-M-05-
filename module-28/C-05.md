## authorId দিয়ে সব কমেন্ট বের করা\*\*। নিচে সার্ভিস + কন্ট্রোলার + রাউটের পূর্ণাঙ্গ উদাহরণ

1️⃣ Service Layer – `comment.service.ts`

```ts
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

// নির্দিষ্ট ইউজারের সব কমেন্ট পাওয়া
export const getCommentsByAuthorId = async (authorId: string) => {
  try {
    if (!authorId || authorId.trim() === "") {
      throw new Error("Author ID দিতে হবে | Author ID is required");
    }

    const comments = await prisma.comment.findMany({
      where: { authorId },
      include: {
        post: {
          select: { id: true, title: true },
        },
        author: {
          select: { id: true, name: true, image: true },
        },
        replies: {
          include: {
            author: {
              select: { id: true, name: true, image: true },
            },
          },
        },
      },
      orderBy: { createdAt: "desc" },
    });

    if (!comments || comments.length === 0) {
      throw new Error(
        "এই ইউজারের কোনো কমেন্ট পাওয়া যায়নি | No comments found for this author"
      );
    }

    return comments;
  } catch (error) {
    console.error("Get Comments By Author Error:", error);
    throw new Error(error.message || "Failed to get comments by author");
  }
};
```

---

## 2️⃣ Controller – `comment.controller.ts`

```ts
import { Request, Response } from "express";
import * as commentService from "./comment.service";

export const getCommentsByAuthorController = async (
  req: Request,
  res: Response
) => {
  try {
    const { authorId } = req.params;

    if (!authorId) {
      return res
        .status(400)
        .json({ success: false, message: "Missing author ID" });
    }

    const comments = await commentService.getCommentsByAuthorId(authorId);
    res.status(200).json({ success: true, comments });
  } catch (error) {
    console.error(error);
    res.status(404).json({ success: false, message: error.message });
  }
};
```

---

## 3️⃣ Route – `comment.routes.ts`

```ts
import { Router } from "express";
import { getCommentsByAuthorController } from "./comment.controller";

const router = Router();

// নির্দিষ্ট ইউজারের সব কমেন্ট
router.get("/authors/:authorId/comments", getCommentsByAuthorController);

export default router;
```

---

## 4️⃣ Example Request

**GET `/api/authors/:authorId/comments`**

```
GET /api/authors/user_123/comments
```

---

## 5️⃣ Example Response

```json
{
  "success": true,
  "comments": [
    {
      "id": "comment_1",
      "content": "Great post!",
      "post": { "id": "post_456", "title": "My First Post" },
      "author": { "id": "user_123", "name": "Arif", "image": "arif.jpg" },
      "replies": [
        {
          "id": "comment_2",
          "content": "Thanks!",
          "author": { "id": "user_456", "name": "Rahim" }
        }
      ]
    }
  ]
}
```

---

✅ এখানে ভ্যালিডেশন আছে (authorId না থাকলে error),  
✅ `include` দিয়ে post, author, replies সব আসছে,  
✅ Error handling করা হয়েছে।
