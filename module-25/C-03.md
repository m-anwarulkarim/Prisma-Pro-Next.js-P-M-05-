## üöÄ Prisma Advanced Search: OR ‡¶è‡¶¨‡¶Ç HAS-‡¶è‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞

Prisma ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡¶ú‡ßá‡¶ï‡ßç‡¶ü‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶ø, ‡¶§‡¶ñ‡¶® ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡¶á ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡ßá (‡¶Ø‡ßá‡¶Æ‡¶®: Title ‡¶¨‡¶æ Content) ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶® ‡¶π‡ßü‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßá‡¶ï ‡¶∏‡¶Æ‡ßü Array ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡ßá‡¶∞ (‡¶Ø‡ßá‡¶Æ‡¶®: Tags) ‡¶≠‡ßá‡¶§‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶§‡ßá ‡¶π‡ßü‡•§ ‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø **OR** ‡¶è‡¶¨‡¶Ç **HAS** ‡¶ï‡¶®‡ßç‡¶°‡¶ø‡¶∂‡¶® ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§

### üõ†Ô∏è ‡¶ï‡ßã‡¶° ‡¶á‡¶Æ‡¶™‡ßç‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∂‡¶®

```ts
import { PrismaClient } from "@prisma/client";
import { Request, Response } from "express";

const prisma = new PrismaClient();

export const advancedSearchPosts = async (req: Request, res: Response) => {
  try {
    // ‡ßß. ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø ‡¶™‡ßç‡¶Ø‡¶æ‡¶∞‡¶æ‡¶Æ‡¶ø‡¶ü‡¶æ‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶ì‡ßü‡¶æ
    const searchText = (req.query.search as string) || "";
    const tag = (req.query.tag as string) || "";

    // ‡ß®. ‡¶™‡ßç‡¶∞‡¶ø‡¶ú‡¶Æ‡¶æ ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø ‡¶∂‡ßÅ‡¶∞‡ßÅ
    const posts = await prisma.post.findMany({
      where: {
        // AND ‡¶ï‡¶®‡ßç‡¶°‡¶ø‡¶∂‡¶® (‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶∂‡¶∞‡ßç‡¶§ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá)
        AND: [
          // ‡¶ï‡¶®‡ßç‡¶°‡¶ø‡¶∂‡¶® ‡ßß: ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá
          {
            OR: [
              { title: { contains: searchText, mode: "insensitive" } },
              { content: { contains: searchText, mode: "insensitive" } },
            ],
          },
          // ‡¶ï‡¶®‡ßç‡¶°‡¶ø‡¶∂‡¶® ‡ß®: ‡¶Ø‡¶¶‡¶ø ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü, ‡¶§‡¶¨‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶§‡¶æ ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá
          tag ? { tags: { has: tag } } : {},
        ],
      },
      orderBy: {
        createdAt: "desc", // ‡¶≤‡ßá‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶Ü‡¶ó‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
      },
    });

    return res.status(200).json({
      success: true,
      total: posts.length,
      data: posts,
    });
  } catch (error) {
    return res
      .status(500)
      .json({ success: false, message: "Server Error", error });
  }
};
```

---

### üìò ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶®‡¶∏‡ßá‡¶™‡ßç‡¶ü ‡¶∏‡¶Æ‡ßÅ‡¶π

#### ‡ßß. `OR` ‡¶ï‡¶®‡ßç‡¶°‡¶ø‡¶∂‡¶® (Multi-field Search)

`OR` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü ‡¶Ø‡¶ñ‡¶® ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶® ‡¶Ø‡ßá ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï ‡¶∂‡¶∞‡ßç‡¶§‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá **‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï‡¶ü‡¶ø** ‡¶∏‡¶§‡ßç‡¶Ø ‡¶π‡¶≤‡ßá‡¶á ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶ï‡•§

- **‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£:** ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ "JavaScript" ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶â‡¶≠‡ßü ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡ßü ‡¶ñ‡ßÅ‡¶Å‡¶ú‡¶ø‡•§ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶è‡¶ï ‡¶ú‡¶æ‡ßü‡¶ó‡¶æ‡ßü ‡¶Æ‡¶ø‡¶≤‡¶≤‡ßá‡¶á ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶ü‡¶ø ‡¶ö‡¶≤‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá‡•§

#### ‡ß®. `HAS` ‡¶Ö‡¶™‡¶æ‡¶∞‡ßá‡¶ü‡¶∞ (Array Search)

‡¶Ø‡¶¶‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶Æ‡¶°‡ßá‡¶≤‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶ø‡¶≤‡ßç‡¶° Array ‡¶π‡ßü (‡¶Ø‡ßá‡¶Æ‡¶®: `tags: String[]`), ‡¶§‡¶¨‡ßá ‡¶∏‡ßá‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞‡ßá ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ ‡¶§‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶§‡ßá `has` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§

- **‡¶ï‡¶æ‡¶ú:** ‡¶è‡¶ü‡¶ø ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶è‡¶≤‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶ñ‡ßá‡•§

#### ‡ß©. `mode: "insensitive"`

‡¶è‡¶ü‡¶ø ‡¶ñ‡ßÅ‡¶¨‡¶á ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø‡•§ ‡¶°‡¶ø‡¶´‡¶≤‡ßç‡¶ü‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö Case-sensitive ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá (‡¶Ö‡¶∞‡ßç‡¶•‡¶æ‡ßé 'Node' ‡¶è‡¶¨‡¶Ç 'node' ‡¶Ü‡¶≤‡¶æ‡¶¶‡¶æ)‡•§ `insensitive` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶π‡¶æ‡¶§‡ßá‡¶∞ ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶õ‡ßã‡¶ü ‡¶π‡¶æ‡¶§‡ßá‡¶∞ ‡¶π‡ßã‡¶ï ‡¶¨‡¶æ ‡¶¨‡ßú ‡¶π‡¶æ‡¶§‡ßá‡¶∞, ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶ö‡¶≤‡ßá ‡¶Ü‡¶∏‡¶¨‡ßá‡•§

---

### üéØ ‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨ ‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£ (Use Cases)

‡¶ß‡¶∞‡ßÅ‡¶® ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡ß©‡¶ü‡¶ø ‡¶™‡ßã‡¶∏‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá:

1. **Post A:** Title: "Learning Node", Tags: ["backend", "javascript"]
2. **Post B:** Title: "React Guide", Tags: ["frontend", "javascript"]
3. **Post C:** Title: "Prisma Tips", Tags: ["database"]

| URL Query                    | ‡¶∞‡ßá‡¶ú‡¶æ‡¶≤‡ßç‡¶ü ‡¶ï‡ßÄ ‡¶Ü‡¶∏‡¶¨‡ßá?   | ‡¶ï‡ßá‡¶® ‡¶Ü‡¶∏‡¶¨‡ßá?                                     |
| ---------------------------- | ------------------ | --------------------------------------------- |
| `?search=node`               | **Post A**         | Title-‡¶è "node" ‡¶Ü‡¶õ‡ßá‡•§                           |
| `?tag=javascript`            | **Post A, Post B** | ‡¶¶‡ßÅ‡¶ü‡ßã‡¶∞‡¶á Tags ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶§‡ßá "javascript" ‡¶Ü‡¶õ‡ßá‡•§        |
| `?search=guide&tag=frontend` | **Post B**         | Title-‡¶è "guide" ‡¶Ü‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç Tag-‡¶è "frontend" ‡¶Ü‡¶õ‡ßá‡•§ |

---

### üí° ‡¶™‡ßç‡¶∞‡ßã-‡¶ü‡¶ø‡¶™: Conditional Object Spread

‡¶ï‡ßã‡¶°‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ `...(tag && { tags: { has: tag } })` ‡¶Ö‡¶•‡¶¨‡¶æ `tag ? { tags: { has: tag } } : {}` ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶ø‡•§ ‡¶è‡¶∞ ‡¶∏‡ßÅ‡¶¨‡¶ø‡¶ß‡¶æ ‡¶π‡¶≤‡ßã:

- ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ `tag` ‡¶®‡¶æ ‡¶™‡¶æ‡¶†‡¶æ‡ßü, ‡¶§‡¶¨‡ßá ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø‡¶§‡ßá ‡¶Ö‡¶π‡ßá‡¶§‡ßÅ‡¶ï `tags` ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ü‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü ‡¶®‡¶æ‡•§ ‡¶è‡¶§‡ßá ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø ‡¶ï‡ßç‡¶≤‡¶ø‡¶® ‡¶•‡¶æ‡¶ï‡ßá ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶π‡ßü‡•§
