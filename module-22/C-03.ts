/*  
===============================================================
ЁЯУМ 6. ржкрзНрж░ржержо ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи рждрзИрж░рж┐ ржУ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЯрзЗржмрж┐рж▓ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛
===============================================================

Prisma Schema ржлрж╛ржЗрж▓рзЗ ржпрзЗ ржоржбрзЗрж▓ржЧрзБрж▓рзЛ рж▓рзЗржЦрж╛ ржЖржЫрзЗ (User, Post ржЗрждрзНржпрж╛ржжрж┐),  
рж╕рзЗржЧрзБрж▓рзЛржХрзЗ PostgreSQL ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ **ржЯрзЗржмрж┐рж▓ ржЖржХрж╛рж░рзЗ рждрзИрж░рж┐** ржХрж░рждрзЗ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржжрж░ржХрж╛рж░ред

ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи рждрзИрж░рж┐ ржУ ржкрзНрж░рзЯрзЛржЧ ржХрж░рж╛рж░ ржХржорж╛ржирзНржб:

    npx prisma migrate dev --name init

ржПржЗ ржХржорж╛ржирзНржб ржХрзА ржХрж░рзЗ?
---------------------
1) Prisma schema ржкрзЬрзЗ  
2) рж╕рзЗржЗ рж╕рзНржХрж┐ржорж╛ ржЕржирзБржпрж╛рзЯрзА PostgreSQL-ржП ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рзЗ  
3) prisma/migrations ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржПржХржЯрж┐ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзЗ  
4) ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЖржкржбрзЗржЯрзЗржб ржЕржмрж╕рзНржерж╛рзЯ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзЗ  

ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи рж╣рж▓рзЛ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗрж░ тАЬрж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ ржЗрждрж┐рж╣рж╛рж╕тАЭтАФ  
ржпрзЗржоржи ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐, ржХрж▓рж╛ржо ржпрзЛржЧ, ржХрж▓рж╛ржо ржкрж░рж┐ржмрж░рзНрждржи ржЗрждрзНржпрж╛ржжрж┐рж░ рж░рзЗржХрж░рзНржбред

===============================================================
ЁЯУМ Prisma Client ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж╛
===============================================================

ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ рж╣ржУрзЯрж╛рж░ ржкрж░ Prisma Client ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ рж╣рзЯ:

    npx prisma generate

Prisma Client ржХрзА?
---------------------
Prisma Client ржПржХржЯрж┐ ржЕржЯрзЛржорзНржпрж╛ржЯрж┐ржХрж▓рж┐ ржЬрзЗржирж╛рж░рзЗржЯ рж╣ржУрзЯрж╛ TypeScript рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐,  
ржпрж╛ ржжрж┐рзЯрзЗ ржЦрзБржм рж╕рж╣ржЬржнрж╛ржмрзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржХрзБрзЯрзЗрж░рж┐ ржЪрж╛рж▓рж╛ржирзЛ ржпрж╛рзЯтАФ

ржпрзЗржоржи:
- user.create()
- post.findMany()
- user.update()
- post.delete()

рж╕ржм ржлрж╛ржВрж╢ржи ржЯрж╛ржЗржк-рж╕рзЗржЗржл, ржЕрж░рзНржерж╛рзО ржнрзБрж▓ ржбрзЗржЯрж╛ ржкрж╛ржарж╛рж▓рзЗ TypeScript ржирж┐ржЬрзЗржЗ ржзрж░рж┐рзЯрзЗ ржжрзЗржмрзЗред

===============================================================
ЁЯУМ 7. Prisma Client ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ рждрзИрж░рж┐ (Adapter рж╕рж╣)
===============================================================

Prisma ORM PostgreSQL-ржПрж░ рж╕ржЩрзНржЧрзЗ ржХрж╛ржирзЗржХрзНржЯ ржХрж░рждрзЗ ржПржХржЯрж┐ тАЬdriver adapterтАЭ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред  
ржПржЗ ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░ Prisma Client-ржПрж░ ржнрзЗрждрж░ ржмрж╕рзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржХрж╛ржирзЗржХрж╢ржи рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рзЗред

тЮб Prisma Client ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржПржХржЯрж┐ ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯ:  
   **lib/prisma.ts**

ржлрж╛ржЗрж▓ржЯрж┐:

---------------------------------------------------------------
lib/prisma.ts
---------------------------------------------------------------
import "dotenv/config";
import { PrismaPg } from '@prisma/adapter-pg'
import { PrismaClient } from '../generated/prisma/client'

const connectionString = `${process.env.DATABASE_URL}`

// PostgreSQL ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░ рждрзИрж░рж┐
const adapter = new PrismaPg({ connectionString })

// Prisma Client ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ рждрзИрж░рж┐
const prisma = new PrismaClient({ adapter })

export { prisma }
---------------------------------------------------------------

ржмрзНржпрж╛ржЦрзНржпрж╛:
----------
1) `dotenv/config` тЖТ .env ржлрж╛ржЗрж▓ ржерзЗржХрзЗ DATABASE_URL рж▓рзЛржб ржХрж░рзЗ  
2) `PrismaPg` тЖТ PostgreSQL-ржПрж░ ржЬржирзНржп Prisma ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░  
3) `PrismaClient` тЖТ Prisma-ржПрж░ ржкрзНрж░ржзрж╛ржи ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ  
4) adapter ржкрж╛рж╕ ржХрж░рж▓рзЗ Prisma ржЬрж╛ржирзЗ PostgreSQL-ржП ржХрзАржнрж╛ржмрзЗ ржХрж╛ржирзЗржХрзНржЯ ржХрж░рждрзЗ рж╣ржмрзЗ  
5) ржПржЗ `prisma` ржЕржмржЬрзЗржХрзНржЯ ржкрзБрж░рзЛ ржЕрзНржпрж╛ржкрзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржХрзБрзЯрзЗрж░рж┐рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ  

===============================================================
ЁЯУМ 8. ржкрзНрж░ржержо ржХрзБрзЯрзЗрж░рж┐ рж▓рзЗржЦрж╛ (User + Post рждрзИрж░рж┐ ржПржмржВ ржбрзЗржЯрж╛ ржкрзЬрж╛)
===============================================================

ржПржЦржи ржПржХржЯрж┐ script.ts ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзЗ ржжрзЗржЦрж╛ ржпрж╛ржХ, ржбрж╛ржЯрж╛ржмрзЗрж╕ ржарж┐ржХржорждрзЛ ржХрж╛ржЬ ржХрж░ржЫрзЗ ржХрж┐ржирж╛ред

ржлрж╛ржЗрж▓: script.ts
---------------------------------------------------------------
import { prisma } from './lib/prisma'

async function main() {
  // ржирждрзБржи ржЗржЙржЬрж╛рж░ рждрзИрж░рж┐ ржХрж░рж╛ + рждрж╛рж░ рж╕рж╛ржерзЗ ржПржХржЯрж┐ ржкрзЛрж╕рзНржЯ ржпрзБржХрзНржд ржХрж░рж╛
  const user = await prisma.user.create({
    data: {
      name: 'Alice',
      email: 'alice@prisma.io',
      posts: {
        create: {
          title: 'Hello World',
          content: 'This is my first post!',
          published: true,
        },
      },
    },
    include: {
      posts: true,
    },
  })
  console.log('Created user:', user)

  // рж╕ржм ржЗржЙржЬрж╛рж░ ржУ рждрж╛ржжрзЗрж░ ржкрзЛрж╕рзНржЯ ржкрзЬрж╛
  const allUsers = await prisma.user.findMany({
    include: {
      posts: true,
    },
  })
  console.log('All users:', JSON.stringify(allUsers, null, 2))
}

main()
  .then(async () => {
    await prisma.$disconnect()
  })
  .catch(async (e) => {
    console.error(e)
    await prisma.$disconnect()
    process.exit(1)
  })
---------------------------------------------------------------

ржПржЗ ржХрзЛржб ржХрзА ржХрж░ржЫрзЗ?
-------------------
1) `prisma.user.create()` ржжрж┐рзЯрзЗ ржирждрзБржи ржЗржЙржЬрж╛рж░ + рждрж╛рж░ ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐  
2) `include.posts` ржжрж┐рзЯрзЗ рждрзИрж░рж┐ ржХрж░рж╛ ржкрзЛрж╕рзНржЯ рж░рзЗржЬрж╛рж▓рзНржЯрзЗ ржкрж╛ржУрзЯрж╛  
3) `prisma.user.findMany()` ржжрж┐рзЯрзЗ ржПржХрж╕рж╛ржерзЗ рж╕ржм ржЗржЙржЬрж╛рж░ + ржкрзЛрж╕рзНржЯ ржкрзЬрж╛  
4) рж╢рзЗрж╖рзЗ `prisma.$disconnect()` ржжрж┐рзЯрзЗ ржХрж╛ржирзЗржХрж╢ржи ржмржирзНржз ржХрж░рж╛  

рж╕рзНржХрзНрж░рж┐ржкрзНржЯ рж░рж╛ржи ржХрж░рждрзЗ:

    npx tsx script.ts

рж░рзЗржЬрж╛рж▓рзНржЯ:
---------
- ржирждрзБржи ржЗржЙржЬрж╛рж░рзЗрж░ ржбрзЗржЯрж╛ ржХржирж╕рзЛрж▓рзЗ ржжрзЗржЦрж╛ржмрзЗ  
- рж╕ржм ржЗржЙржЬрж╛рж░рзЗрж░ рж╕ржорзНржкрзВрж░рзНржг рждрж╛рж▓рж┐ржХрж╛ JSON ржЖржХрж╛рж░рзЗ ржжрзЗржЦрж╛ржмрзЗ  

===============================================================
ЁЯУМ 9. Prisma Studio ржжрж┐рзЯрзЗ ржнрж┐ржЬрзНржпрзБрзЯрж╛рж▓ ржбрзЗржЯрж╛ ржжрзЗржЦрж╛
===============================================================

Prisma Studio рж╣рж▓ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржжрзЗржЦрж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржнрж┐ржЬрзНржпрзБрзЯрж╛рж▓ UIред  
ржПржЦрж╛ржи ржерзЗржХрзЗ:

- ржбрзЗржЯрж╛ ржжрзЗржЦрж╛  
- ржбрзЗржЯрж╛ ржПржбрж┐ржЯ ржХрж░рж╛  
- ржирждрзБржи рж░рзЛ ржпрзЛржЧ ржХрж░рж╛  
- ржЯрзЗржмрж┐рж▓ ржмрзНрж░рж╛ржЙржЬ ржХрж░рж╛  

рж╕ржм ржХрж░рж╛ ржпрж╛рзЯ ржЦрзБржм рж╕рж╣ржЬрзЗред

Studio ржЪрж╛рж▓рж╛ржирзЛрж░ ржХржорж╛ржирзНржб:

    npx prisma studio --config ./prisma.config.ts

ржПржЗ ржХржорж╛ржирзНржб ржЪрж╛рж▓рж╛рж▓рзЗ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржПржХржЯрж┐ GUI ржУржкрзЗржи рж╣ржмрзЗ  
ржпрзЗржЦрж╛ржирзЗ User ржУ Post ржЯрзЗржмрж┐рж▓рзЗрж░ ржбрзЗржЯрж╛ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗред

===============================================================
ЁЯУМ рж╕рж╛рж░рж╛ржВрж╢
===============================================================
- migrate dev тЖТ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рзЗ  
- prisma generate тЖТ Prisma Client ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рзЗ  
- prisma.ts тЖТ Prisma Client ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ рждрзИрж░рж┐ ржХрж░рзЗ  
- script.ts тЖТ ржбрзЗржЯрж╛ рждрзИрж░рж┐ ржУ ржкрзЬрж╛рж░ ржкрзНрж░ржержо ржбрзЗржорзЛ  
- prisma studio тЖТ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржнрж┐ржЬрзНржпрзБрзЯрж╛рж▓рж┐ ржжрзЗржЦрж╛рж░ UI  

ржПржЗ ржзрж╛ржкржЧрзБрж▓рзЛ рж╢рзЗрж╖ ржХрж░рж▓рзЗ Prisma + PostgreSQL ржкрзБрж░рзЛржкрзБрж░рж┐ ржХрж╛ржЬ ржХрж░ржмрзЗред
*/
