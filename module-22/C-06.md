## ЁЯЪА Prisma Client

ржПржЗ ржЧрж╛ржЗржбрзЗ рж╢рзЗржЦрж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ ржХрзАржнрж╛ржмрзЗ **Prisma Client** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржЙржкрж╛рзЯрзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЕржкрж╛рж░рзЗрж╢ржи ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рждрзЗ рж╣рзЯ ржПржмржВ ржХрж╛ржирзЗржХрж╢ржи рж▓рж╛ржЗржлрж╕рж╛ржЗржХрзЗрж▓ ржорзНржпрж╛ржирзЗржЬ ржХрж░рждрзЗ рж╣рзЯред

### ЁЯЦея╕П ржЗржирзНржбрж╛рж╕рзНржЯрзНрж░рж┐ рж╕рзНржЯрзНржпрж╛ржирзНржбрж╛рж░рзНржб ржХрзЛржб ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи

рж░рж┐рзЯрзЗрж▓ ржУрзЯрж╛рж░рзНрж▓рзНржб ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗ ржЖржорж░рж╛ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЕржкрж╛рж░рзЗрж╢ржиржЧрзБрж▓рзЛржХрзЗ `try-catch-finally` ржмрзНрж▓ржХрзЗрж░ ржорж╛ржзрзНржпржорзЗ рж╕рзБрж░ржХрзНрж╖рж┐ржд ржХрж░рж┐ ржПржмржВ ржирзЗрж╕рзНржЯрзЗржб рж░рж╛ржЗржЯ (Nested Write) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржмрзГржжрзНржзрж┐ ржХрж░рж┐ред

```typescript
// prisma-example.ts
import { PrismaClient } from "@prisma/client";

// рзз. Prisma Client ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬ ржХрж░рж╛ (Singleton Pattern ржЕржирзБрж╕рж░ржг ржХрж░рж╛ рж╢рзНрж░рзЗрзЯ)
const prisma = new PrismaClient();

/**
 * createUserData() ржлрж╛ржВрж╢ржи:
 * ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗрж░ ржорзВрж▓ ржХрж╛ржЬржЧрзБрж▓рзЛ (CRUD) ржХрж░ржмред
 */
async function createUserData() {
  try {
    console.log("тП│ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЕржкрж╛рж░рзЗрж╢ржи рж╢рзБрж░рзБ рж╣ржЪрзНржЫрзЗ...");

    // рзи. ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржкржжрзНржзрждрж┐: ржПржХ ржХрзБрзЯрзЗрж░рж┐рждрзЗ ржЗржЙржЬрж╛рж░ ржУ ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐ (Nested Write)
    const newUser = await prisma.user.create({
      data: {
        name: "Anwarul",
        email: "anwarul.dev@example.com",
        age: 25,
        // Relation: ржПржХрж╕рж╛ржерзЗржЗ ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ
        posts: {
          create: {
            title: "Prisma Mastery",
            content: "ржЖржЬ ржЖржорж┐ Prisma-рж░ ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржЗржоржкрзНрж▓рж┐ржорзЗржирзНржЯрзЗрж╢ржи рж╢рж┐ржЦрж▓рж╛ржо!",
            published: true,
          },
        },
      },
      // рждрзИрж░рж┐ рж╣ржУрзЯрж╛ ржкрзЛрж╕рзНржЯрзЗрж░ ржбрж╛ржЯрж╛ ржЖржЙржЯржкрзБржЯрзЗ ржкрж╛ржУрзЯрж╛рж░ ржЬржирзНржп include ржмрзНржпржмрж╣рж╛рж░
      include: {
        posts: true,
      },
    });

    console.log("тЬЕ ржЗржЙржЬрж╛рж░ ржУ ржкрзЛрж╕рзНржЯ рж╕ржлрж▓ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣рзЯрзЗржЫрзЗ:", newUser);
  } catch (error: any) {
    // рзй. ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ: ржбрж╛ржЯрж╛ржмрзЗрж╕ ржмрж╛ ржХрзЛржбрзЗрж░ ржнрзБрж▓ ржПржЦрж╛ржирзЗ ржзрж░рж╛ ржкрзЬржмрзЗ
    if (error.code === "P2002") {
      console.error(
        "тЭМ ржнрзБрж▓: ржПржЗ ржЗржорзЗржЗрж▓ржЯрж┐ ржЕрж▓рж░рзЗржбрж┐ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЖржЫрзЗ (Unique Constraint)."
      );
    } else {
      console.error("тЭМ ржПржХржЯрж┐ ржЕржЬрж╛ржирж╛ ржПрж░рж░ ржШржЯрзЗржЫрзЗ:", error.message);
    }
  } finally {
    // рзк. рж▓рж╛ржЗржлрж╕рж╛ржЗржХрзЗрж▓ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ: ржЕржкрж╛рж░рзЗрж╢ржи рж╢рзЗрж╖рзЗ ржХрж╛ржирзЗржХрж╢ржи ржмржирзНржз ржХрж░рж╛
    // ржПржЯрж┐ ржХрж╛ржирзЗржХрж╢ржи рж▓рж┐ржХ рж░рзЛржз ржХрж░рзЗ ржПржмржВ рж░рж┐рж╕рзЛрж░рзНрж╕ рж╕рж╛рж╢рзНрж░рзЯ ржХрж░рзЗред
    await prisma.$disconnect();
    console.log("ЁЯФМ Prisma ржХрж╛ржирзЗржХрж╢ржи рж╕ржлрж▓ржнрж╛ржмрзЗ ржмржирзНржз ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред");
  }
}

// ржлрж╛ржВрж╢ржиржЯрж┐ рж░рж╛ржи ржХрж░рж╛
createUserData();
```

---

### ЁЯза ржорзВрж▓ ржХржирж╕рзЗржкрзНржЯрж╕ржорзВрж╣рзЗрж░ ржмрзНржпрж╛ржЦрзНржпрж╛ (Core Concepts)

#### рзз. Nested Writes (ржирзЗрж╕рзНржЯрзЗржб рж░рж╛ржЗржЯ)

ржЖржЧрзЗ ржЖржорж░рж╛ ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ ржЗржЙржЬрж╛рж░ ржПржмржВ ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐ ржХрж░рждрж╛ржоред ржХрж┐ржирзНрждрзБ ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржкржжрзНржзрждрж┐рждрзЗ `posts: { create: { ... } }` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржПржХ рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯрзЗржЗ рж░рж┐рж▓рзЗрж╢ржирж╛рж▓ ржбрж╛ржЯрж╛ рж╕рзЗржн ржХрж░рж╛ ржпрж╛рзЯред ржПржЯрж┐ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗрж░ ржУржкрж░ ржЪрж╛ржк ржХржорж╛рзЯ ржПржмржВ ржХрж╛ржЬ ржжрзНрж░рзБржд ржХрж░рзЗред

#### рзи. `include` ржПрж░ ржмрзНржпржмрж╣рж╛рж░

ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ Prisma рж░рж┐рж▓рзЗрж╢ржирж╛рж▓ ржбрж╛ржЯрж╛ (ржпрзЗржоржи ржкрзЛрж╕рзНржЯ) рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ ржирж╛ред `include: { posts: true }` ржпрзЛржЧ ржХрж░рж▓рзЗ ржЖржкржирж┐ рж░рзЗрж╕ржкржирзНрж╕рзЗржЗ ржЗржЙржЬрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ рждрж╛рж░ ржкрзЛрж╕рзНржЯржЧрзБрж▓рзЛ ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржиред

#### рзй. ржЙржирзНржиржд ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ (Error Codes)

Prisma ржПрж░ ржирж┐ржЬрж╕рзНржм ржПрж░рж░ ржХрзЛржб ржЖржЫрзЗред ржпрзЗржоржи: **P2002** ржорж╛ржирзЗ рж╣рж▓рзЛ ржЗржЙржирж┐ржХ ржлрж┐рж▓рзНржбрзЗ ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржбрж╛ржЯрж╛ ржжрзЗржУрзЯрж╛ рж╣рзЯрзЗржЫрзЗред ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржХрзЛржбрзЗ ржПржЗ ржХрзЛржбржЧрзБрж▓рзЛ ржЪрзЗржХ ржХрж░рзЗ ржЗржЙржЬрж╛рж░ржХрзЗ рж╕ржарж┐ржХ ржорзЗрж╕рзЗржЬ ржжрзЗржУрзЯрж╛ рж╣рзЯред

#### рзк. `finally` ржмрзНрж▓ржХрзЗрж░ ржЧрзБрж░рзБрждрзНржм

ржбрж╛ржЯрж╛ржмрзЗрж╕ ржХрж╛ржирзЗржХрж╢ржи ржПржХржЯрж┐ рж╕рзАржорж┐ржд рж╕ржорзНржкржжред ржХрзЛржбрзЗ ржПрж░рж░ ржЖрж╕рзБржХ ржмрж╛ ржирж╛ ржЖрж╕рзБржХ, `$disconnect()` ржХрж▓ ржХрж░рж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ ржпрзЗ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржк ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржХрж╛ржирзЗржХрж╢ржи ржзрж░рзЗ рж░рж╛ржЦржЫрзЗ ржирж╛ред ржПржХрзЗ **Resource Cleanup** ржмрж▓рж╛ рж╣рзЯред

---

### тЬЕ ржкрзНрж░ржлрзЗрж╢ржирж╛рж▓ ржЯрж┐ржкрж╕:

- **Singleton Pattern:** ржмрзЬ ржкрзНрж░ржЬрзЗржХрзНржЯрзЗ рж╕ржмрж╕ржорзЯ ржПржХржЯрж┐ ржлрж╛ржЗрж▓ (ржпрзЗржоржи: `lib/prisma.ts`) ржерзЗржХрзЗ ржХрзНрж▓рж╛рзЯрзЗржирзНржЯ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рзБржи ржпрж╛рждрзЗ ржмрж╛рж░ржмрж╛рж░ ржирждрзБржи ржХрж╛ржирзЗржХрж╢ржи рждрзИрж░рж┐ ржирж╛ рж╣рзЯред
- **Validation:** ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржкрж╛ржарж╛ржирзЛрж░ ржЖржЧрзЗ `Zod` ржмрж╛ `Joi` рж▓рж╛ржЗржмрзНрж░рзЗрж░рж┐ ржжрж┐рзЯрзЗ ржЗржЙржЬрж╛рж░рзЗрж░ ржЗржиржкрзБржЯ ржнрзНржпрж╛рж▓рж┐ржбрзЗржЯ ржХрж░рзЗ ржирж┐ржиред
- **Environment Variables:** ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЗржЙржЖрж░ржПрж▓ рж╕рж░рж╛рж╕рж░рж┐ ржХрзЛржбрзЗ ржирж╛ рж▓рж┐ржЦрзЗ рж╕ржмрж╕ржорзЯ `.env` ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
