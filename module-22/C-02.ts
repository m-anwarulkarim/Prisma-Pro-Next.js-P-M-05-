/*  
===============================================================
   PRISMA + POSTGRESQL QUICKSTART (ржмрж╛ржВрж▓рж╛ ржмрзНржпрж╛ржЦрзНржпрж╛ рж╕рж╣)
===============================================================

ЁЯУМ Prisma ORM ржХрж┐?
--------------------
Prisma ORM ржПржХржЯрж┐ ржЖржзрзБржирж┐ржХ ORM (Object Relational Mapping) 
ржпрж╛ JavaScript/TypeScript ржкрзНрж░рзЛржЬрзЗржХрзНржЯрзЗ PostgreSQL, MySQL, SQLite 
ржЗрждрзНржпрж╛ржжрж┐ ржбрзЗржЯрж╛ржмрзЗрж╕рзЗрж░ рж╕ржЩрзНржЧрзЗ ржХрж╛ржЬ ржХрж░рж╛ рж╕рж╣ржЬ ржХрж░рзЗред

Prisma ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕рзБржмрж┐ржзрж╛:
- ржЯрж╛ржЗржк-рж╕рзЗржЗржл ржХрзБрзЯрзЗрж░рж┐ рж▓рзЗржЦрж╛ ржпрж╛рзЯ  
- рж╕рж╣ржЬ рж╕рж┐ржиржЯрзНржпрж╛ржХрзНрж╕ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ  
- ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржУ рж╕рзНржХрж┐ржорж╛ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ рж╕рж╣ржЬ рж╣рзЯ  
- Prisma Client рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ ржЯрж╛ржЗржк ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рзЗ  

===============================================================
ЁЯУМ 1. ржирждрзБржи ржкрзНрж░рзЛржЬрзЗржХрзНржЯ рждрзИрж░рж┐
===============================================================
ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ ржХржорж╛ржирзНржб:

    mkdir hello-prisma
    cd hello-prisma

TypeScript рж╕рзЗржЯржЖржк:

    npm init -y
    npm install typescript tsx @types/node --save-dev
    npx tsc --init

ржПрждрзЗ TypeScript ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи рждрзИрж░рж┐ рж╣ржмрзЗред

===============================================================
ЁЯУМ 2. Prisma ржУ PostgreSQL ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ ржЗржирж╕рзНржЯрж▓
===============================================================

    npm install prisma @types/node @types/pg --save-dev 
    npm install @prisma/client @prisma/adapter-pg pg dotenv

ржкрзНрж░рждрж┐ржЯрж┐ ржкрзНржпрж╛ржХрзЗржЬрзЗрж░ ржХрж╛ржЬ:

- prisma тЖТ Prisma CLI (schema init, migrate, generate ржЗрждрзНржпрж╛ржжрж┐)
- @prisma/client тЖТ Prisma Client ржжрж┐рзЯрзЗ ржХрзБрзЯрзЗрж░рж┐ ржЪрж╛рж▓рж╛ржирзЛ
- @prisma/adapter-pg тЖТ PostgreSQL ржбрзНрж░рж╛ржЗржнрж╛рж░ ржЕрзНржпрж╛ржбрж╛ржкрзНржЯрж╛рж░
- pg тЖТ node-postgres ржбрзНрж░рж╛ржЗржнрж╛рж░
- @types/pg тЖТ TypeScript ржЯрж╛ржЗржк ржбрзЗржлрж┐ржирж┐рж╢ржи
- dotenv тЖТ .env ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ENV рж▓рзЛржб ржХрж░рж╛

===============================================================
ЁЯУМ 3. ESM рж╕рж╛ржкрзЛрж░рзНржЯ ржХржиржлрж┐ржЧрж╛рж░
===============================================================

ЁЯСЙ tsconfig.json

{
  "compilerOptions": {
    "module": "ESNext",
    "moduleResolution": "node",
    "target": "ES2023",
    "strict": true,
    "esModuleInterop": true,
    "ignoreDeprecations": "6.0"
  }
}

ЁЯСЙ package.json

{
  "type": "module"
}

===============================================================
ЁЯУМ 4. Prisma ржкрзНрж░ржХрж▓рзНржк ржЗржирж┐рж╢рж┐рзЯрж╛рж▓рж╛ржЗржЬ
===============================================================

    npx prisma

Prisma schema рждрзИрж░рж┐:

    npx prisma init --datasource-provider postgresql --output ../generated/prisma

ржПрждрзЗ рждрзИрж░рж┐ рж╣ржмрзЗ:
- prisma/schema.prisma  
- .env  
- prisma.config.ts  

===============================================================
ЁЯУМ prisma.config.ts (ржбрж┐ржлрж▓рзНржЯ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи)
===============================================================

import 'dotenv/config'
import { defineConfig, env } from 'prisma/config'

export default defineConfig({
  schema: 'prisma/schema.prisma',
  migrations: {
    path: 'prisma/migrations',
  },
  datasource: {
    url: env('DATABASE_URL'),
  },
})

ржмрзНржпрж╛ржЦрзНржпрж╛:
- schema тЖТ ржХрзЛржерж╛рзЯ Prisma schema рж░рж╛ржЦрж╛ ржЖржЫрзЗ  
- migrations тЖТ ржХрзЛржерж╛рзЯ ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржлрж╛ржЗрж▓ ржпрж╛ржмрзЗ  
- datasource.url тЖТ .env ржерзЗржХрзЗ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржХрж╛ржирзЗржХрж╢ржи  

===============================================================
ЁЯУМ 5. PostgreSQL ржХрж╛ржирзЗржХрж╢ржи рж╕рзНржЯрзНрж░рж┐ржВ (.env)
===============================================================

DATABASE_URL="postgresql://username:password@localhost:5432/mydb?schema=public"

рждржерзНржп:
username тЖТ PostgreSQL ржЗржЙржЬрж╛рж░  
password тЖТ PostgreSQL ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб  
localhost тЖТ рж╣рзЛрж╕рзНржЯ  
5432 тЖТ PostgreSQL ржкрзЛрж░рзНржЯ  
mydb тЖТ ржбрж╛ржЯрж╛ржмрзЗрж╕ ржирж╛ржо  

===============================================================
ЁЯУМ 6. Prisma Data Model / Schema
===============================================================

prisma/schema.prisma:

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
  posts Post[]
}

model Post {
  id        Int     @id @default(autoincrement())
  title     String
  content   String?
  published Boolean @default(false)
  author    User    @relation(fields: [authorId], references: [id])
  authorId  Int
}

ЁЯТб ржмрзНржпрж╛ржЦрзНржпрж╛:

User Model:
-------------
id тЖТ auto-increment primary key  
email тЖТ ржЗржЙржирж┐ржХ  
name тЖТ optional  
posts тЖТ рзз ржЬржи ржЗржЙржЬрж╛рж░рзЗрж░ ржПржХрж╛ржзрж┐ржХ ржкрзЛрж╕рзНржЯ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ  

Post Model:
-------------
title тЖТ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ  
content тЖТ optional  
published тЖТ ржбрж┐ржлрж▓рзНржЯ false  
authorId тЖТ User ржЯрзЗржмрж┐рж▓рзЗрж░ рж╕ржЩрзНржЧрзЗ рж░рж┐рж▓рзЗрж╢ржи  

===============================================================
ЁЯУМ 7. ржорж╛ржЗржЧрзНрж░рзЗрж╢ржи ржЪрж╛рж▓рж╛ржирзЛ
===============================================================

ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рждрзЗ:

    npx prisma migrate dev --name init

ржПрждрзЗ:
- PostgreSQL ржП ржЯрзЗржмрж┐рж▓ ржЬрзЗржирж╛рж░рзЗржЯ рж╣ржмрзЗ  
- Prisma Client рждрзИрж░рж┐ рж╣ржмрзЗ  

===============================================================
ЁЯУМ рж╕рж╛рж░рж╛ржВрж╢
===============================================================

ржПржЗ ржзрж╛ржкржЧрзБрж▓рзЛ ржЕржирзБрж╕рж░ржг ржХрж░рж▓рзЗ TypeScript ржкрзНрж░рзЛржЬрзЗржХрзНржЯрзЗ 
Prisma + PostgreSQL рж╕рж╣ржЬрзЗржЗ рж╕рзЗржЯржЖржк ржХрж░рж╛ ржпрж╛рзЯред

ржПржЗ ржбржХрзБржорзЗржирзНржЯ ржмрзНржпрж╛ржЦрзНржпрж╛-ржЙржжрзНржжрзЗрж╢рзНржпрзЗ рждрзИрж░рж┐тАФржХржорж╛ржирзНржбржЧрзБрж▓рзЛ ржмрж╛рж╕рзНрждржмрзЗ ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ ржЪрж╛рж▓рж╛рждрзЗ рж╣рзЯред
*/
