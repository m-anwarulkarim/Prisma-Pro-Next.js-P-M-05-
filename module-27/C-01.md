# ЁЯУС Database Seeding: Admin User Creation (Documentation)

ржПржЗ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржирзЗ ржЖржорж░рж╛ ржЖрж▓рзЛржЪржирж╛ ржХрж░ржм ржХрзАржнрж╛ржмрзЗ ржПржХржЯрж┐ рж╕рзНржХрзНрж░рж┐ржкрзНржЯрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ ржПржХржЬржи **Admin User** рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛рзЯред ржПржХрзЗ рж╕рж╛ржзрж╛рж░ржгржд **"Database Seeding"** ржмрж▓рж╛ рж╣рзЯред

---

## рзз. ржХрзЛржбржЯрж┐рж░ ржорзВрж▓ ржХрж╛ржЬ (At a Glance)

ржПржЗ ржХрзЛржбржЯрж┐ ржорзВрж▓ржд ржЕрзНржпрж╛ржкрзНрж▓рж┐ржХрзЗрж╢ржирзЗрж░ ржЬржирзНржп ржПржХржЬржи ржбрж┐ржлрж▓рзНржЯ ржЕрзНржпрж╛ржбржорж┐ржи рждрзИрж░рж┐ ржХрж░рзЗред ржПржЯрж┐ рж░рж╛ржи ржХрж░рж▓рзЗ рж╕рж┐рж╕рзНржЯрзЗржо ржирж┐ржЬрзЗ ржерзЗржХрзЗржЗ ржЪрзЗржХ ржХрж░рзЗ ржпрзЗ ржЕрзНржпрж╛ржбржорж┐ржи ржЖржЫрзЗ ржХрж┐ ржирж╛, ржирж╛ ржерж╛ржХрж▓рзЗ API ржХрж▓ ржХрж░рзЗ ржирждрзБржи ржЕрзНржпрж╛ржбржорж┐ржи рждрзИрж░рж┐ ржХрж░рзЗ ржПржмржВ рждрж╛рж░ ржЗржорзЗржЗрж▓ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕ ржЖржкржбрзЗржЯ ржХрж░рзЗ ржжрзЗрзЯред

---

## рзи. ржкрзВрж░рзНржгрж╛ржЩрзНржЧ ржХрзЛржб (Source Code)

```javascript
import { prisma } from "../lib/prisma"; // Prisma Client ржЗржоржкрзЛрж░рзНржЯ
import { UserRole } from "../middlewares/auth"; // ржЗржЙржЬрж╛рж░ рж░рзЛрж▓рзЗрж░ ржПржирж╛ржо (Enum) ржЗржоржкрзЛрж░рзНржЯ

async function seedAdmin() {
  try {
    console.log("***** Admin Seeding Started....");

    // ржЕрзНржпрж╛ржбржорж┐ржирзЗрж░ ржкрзНрж░рж╛ржержорж┐ржХ рждржерзНржп
    const adminData = {
      name: "Admin2 Saheb",
      email: "admin2@admin.com",
      role: UserRole.ADMIN,
      password: "admin1234", // .env ржлрж╛ржЗрж▓рзЗ рж░рж╛ржЦрждрзЗ рж╣ржмрзЗ
    };

    console.log("***** Checking Admin Exist or not");

    // рзз. ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЗржЙржЬрж╛рж░ржЯрж┐ ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ рждрж╛ ржЪрзЗржХ ржХрж░рж╛
    const existingUser = await prisma.user.findUnique({
      where: {
        email: adminData.email,
      },
    });

    // ржпржжрж┐ ржЗржЙржЬрж╛рж░ ржерж╛ржХрзЗ, рждржмрзЗ ржПрж░рж░ ржерзНрж░рзЛ ржХрж░ржмрзЗ ржпрзЗржи ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржирж╛ рж╣рзЯ
    if (existingUser) {
      throw new Error("This section is controlled by the admin.!!");
    }

    // рзи. рж▓рзЛржХрж╛рж▓ рж╕рж╛ржЗржи-ржЖржк API ржХрж▓ ржХрж░рзЗ ржирждрзБржи ржЕрзНржпрж╛ржбржорж┐ржи рждрзИрж░рж┐ ржХрж░рж╛ , ржПржЯрж╛ frontEnd ржПрж░ ржХрж╛ржЬрзЗрж░ ржорждрзЛ , ржорж╛ржирзЗ frontEnd ржП ржЗ ржорзВрж▓ржд ржПржнрж╛ржмрзЗ ржХрж░рж╛ рж╣рзЯ
    const signUpAdmin = await fetch(
      "http://localhost:3000/api/auth/sign-up/email",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(adminData),
      }
    );

    // рзй. ржпржжрж┐ рж╕рж╛ржЗржи-ржЖржк рж╕ржлрж▓ рж╣рзЯ, рждржмрзЗ рждрж╛ржХрзЗ ржнрзЗрж░рж┐ржлрж╛ржЗржб рж╣рж┐рж╕рзЗржмрзЗ ржорж╛рж░рзНржХ ржХрж░рж╛
    if (signUpAdmin.ok) {
      console.log("**** Admin created");

      await prisma.user.update({
        where: {
          email: adminData.email,
        },
        data: {
          emailVerified: true, // рж╕рж░рж╛рж╕рж░рж┐ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЗржорзЗржЗрж▓ ржнрзЗрж░рж┐ржлрж╛ржЗржб ржЯрзНрж░рзБ ржХрж░рзЗ ржжрзЗржУрзЯрж╛
        },
      });

      console.log("**** Email verification status updated!");
    }

    console.log("******* SUCCESS: Admin Seeded Successfully ******");
  } catch (error) {
    // ржХрзЛржирзЛ ржПрж░рж░ рж╣рж▓рзЗ рждрж╛ ржХржирж╕рзЛрж▓рзЗ ржкрзНрж░рж┐ржирзНржЯ рж╣ржмрзЗ
    console.error("Error during seeding:", error.message);
  }
}

// ржлрж╛ржВрж╢ржиржЯрж┐ ржХрж▓ ржХрж░рж╛
seedAdmin();
```

---

## рзй. рж╕рзНржЯрзЗржк-ржмрж╛ржЗ-рж╕рзНржЯрзЗржк ржмрзНржпрж╛ржЦрзНржпрж╛ (How it works?)

### ржзрж╛ржк рзз: ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржЪрзЗржХ ржХрж░рж╛

ржХрзЛржбржЯрж┐ ржкрзНрж░ржержорзЗржЗ `prisma.user.findUnique` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржЗржорзЗржЗрж▓ржЯрж┐ ржЦрзБржБржЬрзЗ ржжрзЗржЦрзЗред ржПржЯрж┐ ржЬрж░рзБрж░рж┐ ржХрж╛рж░ржг ржПржХржЗ ржЗржорзЗржЗрж▓рзЗ ржПржХрж╛ржзрж┐ржХ ржЗржЙржЬрж╛рж░ рждрзИрж░рж┐ ржХрж░рждрзЗ ржЧрзЗрж▓рзЗ ржбрж╛ржЯрж╛ржмрзЗржЬ ржПрж░рж░ ржжрж┐ржмрзЗред

### ржзрж╛ржк рзи: API ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЗржЙржЬрж╛рж░ рждрзИрж░рж┐

ржПржЦрж╛ржирзЗ рж╕рж░рж╛рж╕рж░рж┐ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ ржбрж╛ржЯрж╛ ржирж╛ ржврзБржХрж┐рзЯрзЗ `fetch` ржПрж░ ржорж╛ржзрзНржпржорзЗ рж╕рж╛ржЗржи-ржЖржк API ржХрж▓ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред ржПрж░ ржХрж╛рж░ржг рж╣рж▓рзЛ:

- рж╕рж╛ржЗржи-ржЖржк ржХрж░рж╛рж░ рж╕ржорзЯ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб **Hash** ржХрж░рж╛рж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рзЯред
- API ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ рж╕рж┐рж╕рзНржЯрзЗржорзЗрж░ ржмрж┐ржЬржирзЗрж╕ рж▓ржЬрж┐ржХ ржмржЬрж╛рзЯ ржерж╛ржХрзЗред

### ржзрж╛ржк рзй: ржЗржорзЗржЗрж▓ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи ржЕржЯрзЛржорзЗрж╢ржи

ржЕрзНржпрж╛ржбржорж┐ржи ржпрзЗрж╣рзЗрждрзБ ржЖржорж░рж╛ ржирж┐ржЬрзЗрж░рж╛ржЗ рждрзИрж░рж┐ ржХрж░ржЫрж┐, рждрж╛ржЗ ржЕрзНржпрж╛ржбржорж┐ржиржХрзЗ ржмрж╛рж░ржмрж╛рж░ ржЗржорзЗржЗрж▓ рж▓рж┐ржВржХрзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржнрзЗрж░рж┐ржлрж╛ржЗ ржХрж░рж╛рж░ ржЭрж╛ржорзЗрж▓рж╛ ржерзЗржХрзЗ ржорзБржХрзНрждрж┐ ржжрж┐рждрзЗ рж╕рж░рж╛рж╕рж░рж┐ ржбрж╛ржЯрж╛ржмрзЗржЬрзЗ `emailVerified: true` ржХрж░рзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯрзЗржЫрзЗред

---

### 4. ржЯрж┐ржкрж╕: `package.json`-ржП ржХржорж╛ржирзНржб рж╕рзЗржЯржЖржк

ржпржжрж┐ ржЪрж╛ржи ржпрзЗ ржмрж╛рж░ржмрж╛рж░ ржлрж╛ржЗрж▓рзЗрж░ ржкрж╛рже ржирж╛ рж▓рж┐ржЦрзЗ ржПржХржЯрж┐ ржЫрзЛржЯ ржХржорж╛ржирзНржб ржжрж┐рзЯрзЗ ржПржЯрж┐ рж░рж╛ржи ржХрж░ржмрзЗржи, рждржмрзЗ ржЖржкржирж╛рж░ **`package.json`** ржлрж╛ржЗрж▓рзЗрж░ `scripts` ржЕржВрж╢рзЗ ржПржЯрж┐ ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи:

```json
"scripts": {
  "seed:admin": "ts-node src/scripts/seed-admin.ts"
}

```

_(ржирзЛржЯ: ржпржжрж┐ ржЯрж╛ржЗржкрж╕рзНржХрзНрж░рж┐ржкрзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗржи рждржмрзЗ `ts-node` рж▓рж╛ржЧржмрзЗ, ржЖрж░ ржЬрж╛ржнрж╛рж╕рзНржХрзНрж░рж┐ржкрзНржЯ рж╣рж▓рзЗ рж╢рзБржзрзБ `node` ржжрж┐рж▓рзЗржЗ рж╣ржмрзЗ)_

ржПржЦржи ржЖржкржирж┐ ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ рж╢рзБржзрзБ `npm run seed:admin` рж▓рж┐ржЦрж▓рзЗржЗ рж╕рзНржХрзНрж░рж┐ржкрзНржЯржЯрж┐ ржХрж╛ржЬ ржХрж░рж╛ рж╢рзБрж░рзБ ржХрж░ржмрзЗред
